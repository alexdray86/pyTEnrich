

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Detailed methods &mdash; pyTEnrich 0.3 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using a genome subset" href="genome_subset.html" />
    <link rel="prev" title="Output" href="output.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> pyTEnrich
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="execution.html">Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Output</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Detailed methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="genome_subset.html">Using a genome subset</a></li>
<li class="toctree-l1"><a class="reference internal" href="otherspecies.html">Working with other species</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis_ex.html">Analysis example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/pyTEnrich.html">pyTEnrich package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyTEnrich</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Detailed methods</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/usage/detailmethods.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="detailed-methods">
<span id="detailmethods"></span><h1>Detailed methods<a class="headerlink" href="#detailed-methods" title="Permalink to this headline">Â¶</a></h1>
<p><strong>Binomial Model</strong></p>
<p>The enrichment is performed using a binomial test. The binomial test is an exact test of the statistical significance of deviations from a theoretically expected distribution, considering two possible outcome. In our case : TE overlap with peak (success) or do not overlap (failure). The statistical hypothesis is :</p>
<div class="math notranslate nohighlight">
\[{\displaystyle H_{0}:p_{obs} =p_{exp}}\]</div>
<p>where <span class="math notranslate nohighlight">\(p_{exp}\)</span> is the ratio of genome occupancy of each TE family. <span class="math notranslate nohighlight">\(p_{exp}\)</span> is therefore the expectation based on genome occupancy, and <span class="math notranslate nohighlight">\(p_{obs}\)</span> is the observed overlap. Since the probability of having k successes from n trials is given by</p>
<div class="math notranslate nohighlight">
\[P(B = k) = \binom{n}{k} p^k (1 - p)^{n - k}\]</div>
<p>We can calculate the probability to have at least k success by suming up probabilities, from k success to n success. As often the number of success is on the low edge, we prefer to compute the inverse probability :</p>
<div class="math notranslate nohighlight">
\[P(B &gt;= k) = 1 - P(B &lt; k) = 1 - \sum_{i=0}^{k-1} \binom{n}{i} p^i (1 - p)^{n - i}\]</div>
<p>This probability is our p-value of having at least k success, given a probability p for the overlap, and n trials. The p-values obtained above are then adjusted with the Benjamin-Hochsberg method to correct for multiple testing.</p>
<p><strong>Assumptions</strong></p>
<p>The binomial model itself comes with its associated assumptions :</p>
<blockquote>
<div><ul class="simple">
<li><p>The n trials are mutually independent. The <em>trials</em>, in the case of ChIP-seq peaks, as not really independant. Considering the large size of the genome, this assumption seems reasonable.</p></li>
<li><p>The probability of a given outcome is the same for all n samples. We assume that the probability to touch a given TE family/subfamily is the same for each peak (or input sequence) at each trial. This probability is equal to the ratio of genome occupancy and considered as the probability to touch a TE family/subfamily if we would randomly shuffle sequences.</p></li>
<li><p>The only source of variation is simple random and binomial. This assumptions is of course broken as ChIP-seq peaks are by nature not random. It might nevertheless be true for the expected probability if we would random shuffle sequence.</p></li>
</ul>
</div></blockquote>
<p><strong>Two different comparison</strong></p>
<p>From our perpective, there is a few additional assumptions to be taken into account :</p>
<ul class="simple">
<li><p>We assume that the ratio of genome occupancy corresponds to the expected probability if we would random shuffle sequences. As we are dealing with intervals and not single base pair, the probability might be biased by interval length.</p></li>
</ul>
<p>To be as precise as possible, <em>pyTEnrich</em> will choose one out of two different comparisons, either <em>te_in_peak</em> or <em>peak_in_te</em>.</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="genome_subset.html" class="btn btn-neutral float-right" title="Using a genome subset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="output.html" class="btn btn-neutral float-left" title="Output" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Laboratory of Virology and Genetics.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>