

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Overview of the methods &mdash; pyTEnrich 0.6 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="usage/installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#">
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/execution.html">Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/output.html">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/detailmethods.html">Detailed methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/genome_subset.html">Using a genome subset</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/otherspecies.html">Working with other species</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/analysis_ex.html">Analysis example</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/pyTEnrich.html">pyTEnrich class &amp; functions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">pyTEnrich</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Overview of the methods</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <img alt="_images/pyTEnrich_logo_design.png" src="_images/pyTEnrich_logo_design.png" />
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/execution.html">Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/output.html">Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/detailmethods.html">Detailed methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/genome_subset.html">Using a genome subset</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/otherspecies.html">Working with other species</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage/analysis_ex.html">Analysis example</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/pyTEnrich.html">pyTEnrich class &amp; functions</a></li>
</ul>
</div>
<div class="section" id="overview-of-the-methods">
<h1>Overview of the methods<a class="headerlink" href="#overview-of-the-methods" title="Permalink to this headline">Â¶</a></h1>
<p><strong>pyTEnrich</strong> compare the overlap between input bed files and transposable elements families, using a binomial model to compare the observed overlap to the expected one. The expected overlap is derived from genome occupancy of TE families and compared to the observed overlap to highlight potential over-representation of TE families / subfamilies.</p>
<p><strong>Example</strong></p>
<p>We consider a small genome with one gene composed of two exons, and two TE families. There is 3 ChIP-seq peaks detected :</p>
<img alt="_images/fig1.png" src="_images/fig1.png" />
<p><strong>Step 1 : Compute genome occupancy</strong></p>
<p>First, pyTEnrich compute genome occupancy for TE families and input bed files. Genome occupancy is defined as the total number of base pair (bp) spanned by the TE family, divided by the genome size. It is therefore a ratio of genome occupancy.</p>
<img alt="_images/fig2.jpg" src="_images/fig2.jpg" />
<p>Note that TE genome occupancy are pre-computed for the provided TE database. If another TE database is given, or if a genome subset is provided (explained below), it will be re-computed (takes a few minutes).</p>
<p><strong>Step 2 : Intersect TE and Input bed files and count overlap</strong></p>
<p>Using <a class="reference external" href="https://bedtools.readthedocs.io/en/latest/content/tools/intersect.html">Bedtools intersect</a>, we compute a stringent overlap between input bed files and TE database. The observed overlap can then be compared with the expected overlap.</p>
<img alt="_images/fig3.jpg" src="_images/fig3.jpg" />
<p><strong>Step 3 : Compute the enrichment of TE subfamily / family</strong></p>
<p>The enrichment is performed using a binomial test. The binomial test is an exact test of the statistical significance of deviations from a theoretically expected distribution, considering two possible outcome. In our case : TE overlap with peak (success) or do not overlap (failure). We can calculate the probability to have at least k success by suming up probabilities, from k success to n success:</p>
<div class="math notranslate nohighlight">
\[P(B &gt;= k) = 1 - P(B &lt; k) = 1 - \sum_{i=0}^{k-1} \binom{n}{i} p^i (1 - p)^{n - i}\]</div>
<p>This probability is our p-value of having at least k success, given a probability p for the overlap, and n trials. The p-values obtained above are then adjusted with the Benjamin-Hochsberg method to correct for multiple testing.</p>
<p><a class="reference internal" href="usage/detailmethods.html#detailmethods"><span class="std std-ref">Detailed methods</span></a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="usage/installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Coudray Alexandre, Laboratory of Virology and Genetics at EPFL

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>